[{"id":"5aec8dfe.b647b4","type":"function","z":"34d5fca5.9a9fd4","name":"parse Tv2 Power Sensor","func":"if(msg.req.query !== undefined)\n{\n    if (parseInt(msg.req.query.address)!== 106)\n    {\n        return;\n    }\n    \n    console.log(\"parse Tv2 Power Sensor: [in]: process TV2 input\",msg.req.query);   \n    \n    console.log(\"parse Tv2 Power Sensor: [in]: process TV2 input\");   \n    // let now = new Date().getTime()\n    // var isSourceUpdate = global.get('TV2SkipOnceFor6Sec');\n    // console.log(\"TV2SkipOnceFor6Sec isSourceUpdate: \" + isSourceUpdate);\n    // if(isSourceUpdate!==undefined)\n    // {\n    //   if(now - isSourceUpdate < 6000)\n    //   {\n    //       global.set('TV2SkipOnceFor6Sec',0);\n    //       console.log(\"skip [TV2SkipOnceFor6Sec] event from homekit\");\n    //       return null;\n    //   }\n    // }\n\n    var type = parseInt(msg.req.query.type);\n    \n    if(type == 6)//TV Power Sensor\n    {\n        console.log(\"parse Tv Power Sensor:  [in]: update button state from device with state: \" + parseInt(msg.req.query.state));\n        global.set('TV2',new Date().getTime());\n        msg.payload = {\"Active\":parseInt(msg.req.query.state)}\n        return msg;\n    }\n    \n    console.log(\"parse Tv2 Power Sensor: ERROR!!! [in]: process TV2 input\",msg.req.query);   \n    \n}\nreturn null;","outputs":1,"noerr":0,"x":1330,"y":1140,"wires":[["81c08dc3.510e6"]]}]